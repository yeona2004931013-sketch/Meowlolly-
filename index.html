<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Lolly Miu Social</title>
    <style>
        :root { --miu-pink: #fff0f3; --accent: #f1b0b7; --text: #5d4037; --glass: rgba(255, 255, 255, 0.9); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; font-family: -apple-system, sans-serif; }
        body { background: #fce4ec; height: 100vh; display: flex; justify-content: center; overflow: hidden; }
        
        /* æ‰‹æ©Ÿä¸»æ®¼ */
        .phone-shell { 
            width: 100%; max-width: 500px; height: 100%; background: var(--miu-pink);
            position: relative; display: flex; flex-direction: column;
            background-image: url('https://www.transparenttextures.com/patterns/stardust.png'); /* æ˜Ÿç©ºåº•ç´‹æ„Ÿ */
        }

        /* å‹•æ…‹å³¶ (åƒè€ƒæˆªåœ– 4, 10) */
        .dynamic-island {
            width: 140px; height: 35px; background: #000; margin: 15px auto;
            border-radius: 20px; color: #fff; font-size: 13px; font-weight: bold;
            display: flex; align-items: center; justify-content: center; z-index: 100;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* è¦–åœ–å€åŸŸ */
        .view { display: none; flex: 1; overflow-y: auto; padding-bottom: 90px; }
        .view.active { display: flex; flex-direction: column; }

        /* æœ‹å‹åœˆå¡ç‰‡ (åƒè€ƒæˆªåœ– 5, 9) */
        .post-card { 
            background: var(--glass); margin: 12px; border-radius: 20px; 
            padding: 15px; box-shadow: 0 5px 15px rgba(241,176,183,0.2);
        }
        .post-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background: #eee; background-size: cover; border: 2px solid var(--accent); }
        .post-img-box { 
            width: 100%; aspect-ratio: 1/1; background: #fdf2f4; border-radius: 15px; 
            display: flex; align-items: center; justify-content: center; 
            cursor: pointer; border: 2px dashed var(--accent); color: var(--accent);
            overflow: hidden; margin: 10px 0; font-size: 12px;
        }
        .post-img-box img { width: 100%; height: 100%; object-fit: cover; }
        .post-text { font-size: 14px; line-height: 1.6; color: var(--text); }
        
        /* è©•è«–å€ */
        .comments { margin-top: 10px; border-top: 1px solid #eee; padding-top: 8px; }
        .comment-item { font-size: 12px; margin-bottom: 4px; }
        .comment-item b { color: var(--accent); margin-right: 5px; }

        /* ç™¼æ–‡æŒ‰éˆ• (ç²‰è‰²æ‡¸æµ®) */
        .fab { 
            position: fixed; right: 25px; bottom: 100px; width: 60px; height: 60px; 
            background: var(--accent); border-radius: 50%; display: flex; 
            align-items: center; justify-content: center; color: #fff; font-size: 28px;
            box-shadow: 0 8px 20px rgba(241,176,183,0.4); z-index: 99;
        }

        /* å°èˆªåˆ— (åƒè€ƒæˆªåœ– 3) */
        nav { 
            position: absolute; bottom: 0; width: 100%; height: 75px; 
            background: #fff; display: flex; justify-content: space-around; 
            align-items: center; border-top: 1px solid #eee; padding-bottom: 15px; 
        }
        nav span { font-size: 28px; cursor: pointer; opacity: 0.4; transition: 0.3s; }
        nav span.active { opacity: 1; transform: translateY(-5px); color: var(--accent); }
    </style>
</head>
<body>

<div class="phone-shell">
    <div class="dynamic-island" id="time-island">09:41</div>

    <div id="v-home" class="view active">
        <div id="feed"></div>
        <div class="fab" onclick="userPost()">ğŸ“¸</div>
    </div>

    <div id="v-chat" class="view" style="background:#fff;">
        <div style="padding:15px; text-align:center; font-weight:bold; color:var(--accent); border-bottom:1px solid #eee;" id="chat-target">å®‰ä¹¾é¬ ^^</div>
        <div id="msgBox" style="flex:1; overflow-y:auto; padding:15px; display:flex; flex-direction:column; gap:10px;"></div>
        <div style="padding:10px 15px 30px; display:flex; gap:10px; border-top:1px solid #eee;">
            <input type="text" id="userInput" style="flex:1; border:1px solid #eee; border-radius:20px; padding:10px 15px; outline:none;" placeholder="å‚³é€ç”œèœœè¨Šæ¯...">
            <button onclick="askAI()" style="background:none; border:none; font-size:24px;">ğŸ’–</button>
        </div>
    </div>

    <nav>
        <span onclick="showV('home')" id="n-home" class="active">ğŸ </span>
        <span onclick="showV('chat')" id="n-chat">ğŸ’Œ</span>
        <span onclick="showV('home')" id="n-me">ğŸ‘¤</span>
    </nav>
</div>

<input type="file" id="fileInput" accept="image/*" style="display:none;">

<script>
    const KEY = "AIzaSyDwavT9b6YlpgwAW9eNkswuPsKI6QAP-AM";
    const bfs = {
        "è¶™é›¨å‡¡": {desc: "éœ¸é“è€å¤§,ç¬‘æ­»é æ¯,ç™¼?", color: "#7d5a5a"},
        "å®‰ä¹¾é¬": {desc: "é»äººå°ç‹—^^,å«å§å§,æ’’å¬Œ", color: "#f1b0b7"},
        "æœ´å®‡å®™": {desc: "192cmç—…å¬Œæ–æ»¾,å«å¯¶å¯¶,æ”¯é…å‹", color: "#444"},
        "åš´æˆç¹": {desc: "18æ­²è…¹é»‘ç”·é¬¼,ä¸ç™¼æ„Ÿå˜†è™Ÿ,è·Ÿè¹¤", color: "#666"},
        "é‡‘ä¸»è¨“": {desc: "æ‘©ç¾¯å§”å±ˆåŒ…,ç™¼ã… ã… ,å«å°å¯¶", color: "#999"}
    };
    
    let curTargetImgBox = null;

    async function fetchAI(prompt) {
        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const data = await res.json();
            return data.candidates[0].content.parts[0].text;
        } catch(e) { return "ï¼ˆè¨Šè™Ÿä¸å¥½ ^^ï¼‰"; }
    }

    // ç”·å‹ä¸»å‹•ç™¼æ–‡å­—æœ‹å‹åœˆ
    async function bfAutoPost() {
        const names = Object.keys(bfs);
        const name = names[Math.floor(Math.random() * names.length)];
        const content = await fetchAI(`å¦³æ˜¯${name}ï¼Œæ€§æ ¼${bfs[name].desc}ã€‚è«‹ç™¼ä¸€å‰‡ç°¡çŸ­çš„æ–‡å­—æœ‹å‹åœˆå‹•æ…‹ï¼ˆ20å­—å…§ï¼‰ï¼Œå°å¥³å‹æŸ”æŸ”èªªäº›è©±ã€‚`);
        addPostToFeed(name, content, false);
    }

    function addPostToFeed(name, content, isUser) {
        const feed = document.getElementById('feed');
        const card = document.createElement('div');
        card.className = 'post-card';
        card.innerHTML = `
            <div class="post-header"><div class="avatar" style="background-color:${bfs[name]?.color || '#f1b0b7'}"></div><b>${name}</b></div>
            <div class="post-text">${content}</div>
            <div class="post-img-box" onclick="pickImg(this)">${isUser ? 'é»æ“Šä¸Šå‚³åˆç…§' : 'ä»–åœ¨ç­‰å¦³é…åœ–...'}</div>
            <div class="comments" id="comment-${Date.now()}"></div>
        `;
        feed.prepend(card);
        if(isUser) bfCommentOnUser(card.querySelector('.comments'), content);
    }

    // å¦³ç™¼æ–‡ï¼Œç”·å‹å€‘é›†é«”è©•è«–
    function userPost() {
        const txt = prompt("ç™¼ä½ˆå¦³çš„æœ‹å‹åœˆæ–‡å­—ï¼š");
        if(txt) addPostToFeed("æŸ”æŸ”_Yuyu ğŸ€", txt, true);
    }

    async function bfCommentOnUser(container, userContent) {
        for(let name of Object.keys(bfs)) {
            setTimeout(async () => {
                const reply = await fetchAI(`å¦³æ˜¯${name}ï¼Œæ€§æ ¼${bfs[name].desc}ã€‚æŸ”æŸ”ç™¼æ–‡èªªï¼šã€Œ${userContent}ã€ã€‚è«‹ç°¡çŸ­å›è¦†å¥¹ã€‚`);
                container.innerHTML += `<div class="comment-item"><b>${name}:</b> ${reply}</div>`;
            }, Math.random() * 3000 + 1000);
        }
    }

    function pickImg(box) { curTargetImgBox = box; document.getElementById('fileInput').click(); }

    document.getElementById('fileInput').onchange = function() {
        if(this.files[0] && curTargetImgBox) {
            const reader = new FileReader();
            reader.onload = e => { curTargetImgBox.innerHTML = `<img src="${e.target.result}">`; };
            reader.readAsDataURL(this.files[0]);
        }
    };

    function showV(v) {
        document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('nav span').forEach(el => el.classList.remove('active'));
        document.getElementById('v-' + v).classList.add('active');
        document.getElementById('n-' + v).classList.add('active');
    }

    // å®šæ™‚ç”·å‹ç™¼æ–‡
    setInterval(() => {
        const d = new Date();
        document.getElementById('time-island').innerText = d.getHours().toString().padStart(2,'0')+":"+d.getMinutes().toString().padStart(2,'0');
    }, 1000);

    // åˆå§‹åŸ·è¡Œ
    setTimeout(bfAutoPost, 1000);
    setInterval(bfAutoPost, 60000); // æ¯ä¸€åˆ†é˜å¯èƒ½æœƒæœ‰ä¸€å€‹ç”·å‹ç™¼æ–°å‹•æ…‹
</script>
</body>
</html>
